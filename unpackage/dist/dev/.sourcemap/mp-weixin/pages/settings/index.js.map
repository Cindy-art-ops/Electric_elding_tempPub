{"version":3,"file":"index.js","sources":["pages/settings/index.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc2V0dGluZ3MvaW5kZXgudnVl"],"sourcesContent":["<template>\r\n  <view class=\"page\">\r\n    <view class=\"ios-large-title\">设置</view>\r\n\r\n    <!-- 主题设置 -->\r\n    <view class=\"ios-group\">\r\n      <view class=\"ios-cell row\">\r\n        <text>跟随系统</text>\r\n        <switch :checked=\"followSystem\" @change=\"toggleFollow\" />\r\n      </view>\r\n      <view class=\"ios-cell row\">\r\n        <text>暗色模式</text>\r\n        <switch :checked=\"dark\" :disabled=\"followSystem\" @change=\"toggleDark\" />\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 说明 -->\r\n    <view class=\"ios-card note\">\r\n      <text class=\"ios-subtle\"\r\n        >开启“跟随系统”后，将自动与系统外观保持一致；关闭后可手动切换深浅色。</text\r\n      >\r\n    </view>\r\n  </view>\r\n</template>\r\n<script>\r\nexport default {\r\n  data() {\r\n    const follow = uni.getStorageSync(\"theme_follow\");\r\n    const saved = uni.getStorageSync(\"theme_mode\");\r\n    const followSystem = typeof follow === \"boolean\" ? follow : true;\r\n    const dark = saved === \"dark\";\r\n    return { followSystem, dark };\r\n  },\r\n  methods: {\r\n    toggleFollow(e) {\r\n      this.followSystem = !!e.detail.value;\r\n      uni.setStorageSync(\"theme_follow\", this.followSystem);\r\n      if (this.followSystem) {\r\n        const sys = (uni.getSystemInfoSync && uni.getSystemInfoSync()) || {};\r\n        const systemTheme =\r\n          sys.theme === \"dark\" || sys.theme === \"light\" ? sys.theme : \"light\";\r\n        this.applyTheme(systemTheme);\r\n      } else {\r\n        // 保持当前 dark 状态\r\n        this.applyTheme(this.dark ? \"dark\" : \"light\");\r\n      }\r\n    },\r\n    toggleDark(e) {\r\n      this.dark = !!e.detail.value;\r\n      uni.setStorageSync(\"theme_mode\", this.dark ? \"dark\" : \"light\");\r\n      if (!this.followSystem) {\r\n        this.applyTheme(this.dark ? \"dark\" : \"light\");\r\n      }\r\n    },\r\n    applyTheme(theme) {\r\n      // 交给 App.vue 的方法处理（H5 会设置 data-theme）\r\n      try {\r\n        const t = theme === \"dark\" ? \"dark\" : \"light\";\r\n        // 优先调用全局 App 的 applyTheme 以统一处理\r\n        try {\r\n          const app = typeof getApp === \"function\" ? getApp() : null;\r\n          if (app && app.$vm && typeof app.$vm.applyTheme === \"function\") {\r\n            app.$vm.applyTheme(t);\r\n            return;\r\n          }\r\n        } catch (e) {}\r\n        // #ifdef H5\r\n        document.documentElement.setAttribute(\"data-theme\", t);\r\n        // #endif\r\n        uni.setStorageSync(\"theme_effective\", t);\r\n      } catch (e) {}\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style>\r\n.page {\r\n  padding: 24rpx;\r\n}\r\n.row {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n.note {\r\n  padding: 20rpx;\r\n  margin-top: 12rpx;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'G:/HBuilderX.4.75/HBuilderProjects/孙震老师_电弧焊接/pages/settings/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAyBA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,UAAM,SAASA,cAAAA,MAAI,eAAe,cAAc;AAChD,UAAM,QAAQA,cAAAA,MAAI,eAAe,YAAY;AAC7C,UAAM,eAAe,OAAO,WAAW,YAAY,SAAS;AAC5D,UAAM,OAAO,UAAU;AACvB,WAAO,EAAE,cAAc;EACxB;AAAA,EACD,SAAS;AAAA,IACP,aAAa,GAAG;AACd,WAAK,eAAe,CAAC,CAAC,EAAE,OAAO;AAC/BA,oBAAAA,MAAI,eAAe,gBAAgB,KAAK,YAAY;AACpD,UAAI,KAAK,cAAc;AACrB,cAAM,MAAOA,oBAAI,qBAAqBA,cAAAA,MAAI,kBAAmB,KAAK;AAClE,cAAM,cACJ,IAAI,UAAU,UAAU,IAAI,UAAU,UAAU,IAAI,QAAQ;AAC9D,aAAK,WAAW,WAAW;AAAA,aACtB;AAEL,aAAK,WAAW,KAAK,OAAO,SAAS,OAAO;AAAA,MAC9C;AAAA,IACD;AAAA,IACD,WAAW,GAAG;AACZ,WAAK,OAAO,CAAC,CAAC,EAAE,OAAO;AACvBA,oBAAG,MAAC,eAAe,cAAc,KAAK,OAAO,SAAS,OAAO;AAC7D,UAAI,CAAC,KAAK,cAAc;AACtB,aAAK,WAAW,KAAK,OAAO,SAAS,OAAO;AAAA,MAC9C;AAAA,IACD;AAAA,IACD,WAAW,OAAO;AAEhB,UAAI;AACF,cAAM,IAAI,UAAU,SAAS,SAAS;AAEtC,YAAI;AACF,gBAAM,MAAM,OAAO,WAAW,aAAa,OAAM,IAAK;AACtD,cAAI,OAAO,IAAI,OAAO,OAAO,IAAI,IAAI,eAAe,YAAY;AAC9D,gBAAI,IAAI,WAAW,CAAC;AACpB;AAAA,UACF;AAAA,iBACO,GAAG;AAAA,QAAC;AAIbA,sBAAAA,MAAI,eAAe,mBAAmB,CAAC;AAAA,eAChC,GAAG;AAAA,MAAC;AAAA,IACd;AAAA,EACF;AACH;;;;;;;;;;;ACxEA,GAAG,WAAW,eAAe;"}